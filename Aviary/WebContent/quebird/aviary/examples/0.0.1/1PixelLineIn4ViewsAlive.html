<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script type="text/javascript" src="../../lib/0.0.1/quebird_aviary.js"></script>
<title>Aviary - 1 Pixel line in 4 Views Alive</title>
<script type="text/javascript">
	var aviary1 = new Aviary();
	var frameCount = 0;
	var pixel2Move = 0;
	var delta2MoveX = 0;
	var delta2MoveY = 0;
	
	window.onload = function(e) 
	{ 
		var index;
		var aviaryPixel;
		for(index = 0; index < 15; ++index)
		{ // add all pixels
			aviaryPixel = new AviaryPixel();
			aviaryPixel.setID('pixel' + index);
			aviaryPixel.setPosition({x:(25+10*index), y:(25 + 10*index)});
			aviaryPixel.setColor("#000000");
			aviary1.modelsAdd(aviaryPixel);
		}
		{
			var aviaryView1 = new AviaryView();
			aviaryView1.setID('canvas1');
			aviaryView1.setPosition({x:0,y:0});
			aviaryView1.setWidth(100);
			aviaryView1.setHeight(200);
			aviaryView1.setBackgroundColor("#FF0000");
			aviaryView1.attachCanvasDocumentElement(document.getElementById(aviaryView1.getID()));
			aviary1.viewsAdd(aviaryView1);
		}
		{
			var aviaryView2 = new AviaryView();
			aviaryView2.setID('canvas2');
			aviaryView2.setPosition({x:100,y:0});
			aviaryView2.setWidth(100);
			aviaryView2.setHeight(200);
			aviaryView2.setBackgroundColor("#00FF00");
			aviaryView2.attachCanvasDocumentElement(document.getElementById(aviaryView2.getID()));
			aviary1.viewsAdd(aviaryView2);
		}
		{
			var aviaryView3 = new AviaryView();
			aviaryView3.setID('canvas3');
			aviaryView3.setPosition({x:0,y:0});
			aviaryView3.setWidth(200);
			aviaryView3.setHeight(100);
			aviaryView3.setBackgroundColor("#FF0000");
			aviaryView3.attachCanvasDocumentElement(document.getElementById(aviaryView3.getID()));
			aviary1.viewsAdd(aviaryView3);
		}
		{
			var aviaryView4 = new AviaryView();
			aviaryView4.setID('canvas4');
			aviaryView4.setPosition({x:0,y:100});
			aviaryView4.setWidth(200);
			aviaryView4.setHeight(100);
			aviaryView4.setBackgroundColor("#00FF00");
			aviaryView4.attachCanvasDocumentElement(document.getElementById(aviaryView4.getID()));
			aviary1.viewsAdd(aviaryView4);
		}
		
	    window.requestAnimationFrame(myAnimationFrameUpdate);
	}
	myAnimationFrameUpdate = function(timestamp)
	{
		pixel2Move = frameCount % aviary1.models.length;
		if(pixel2Move == 0)
		{ // move 1 pixel each frame
			var magic = frameCount % (16*aviary1.models.length);
			if(magic < 8*aviary1.models.length)
			{
				if(magic < 4*aviary1.models.length)
				{
					delta2MoveX = Math.abs(delta2MoveX) - 1;
					delta2MoveY = -(Math.abs(delta2MoveY) + 1);
				}
				else
				{
					delta2MoveX = Math.abs(delta2MoveX) + 1;
					delta2MoveY = (Math.abs(delta2MoveY) - 1);
				}
			}
			else 
			{
				if(magic < 12*aviary1.models.length)
				{
					delta2MoveX = -(Math.abs(delta2MoveX) - 1);
					delta2MoveY = -(Math.abs(delta2MoveY) - 1);
				}
				else
				{
					delta2MoveX = -(Math.abs(delta2MoveX) + 1);
					delta2MoveY = (Math.abs(delta2MoveY) + 1);
				}
			}
		}

		var model = aviary1.models[pixel2Move];
		model.setX(model.getX() + delta2MoveX);
		model.setY(model.getY() + delta2MoveY);
		
		aviary1.viewsDraw();
		window.requestAnimationFrame(myAnimationFrameUpdate);
		frameCount++;
	}
</script>
</head>
<body >

<div style="font-size: 0;">
	<canvas id="canvas1"></canvas>
	<canvas id="canvas2"></canvas>
	<br>
	<canvas id="canvas3"></canvas>
	<br>
	<canvas id="canvas4"></canvas>
</div>


</body>
</html>